name: å¯åŠ¨å†…ç½‘APIä»£ç†æœåŠ¡å™¨

on:
  workflow_dispatch:  # æ‰‹åŠ¨è§¦å‘
  schedule:
    - cron: '0 0 * * *'  # æ¯å¤©0ç‚¹è‡ªåŠ¨è§¦å‘ï¼ˆå¯é€‰ï¼Œç”¨äºä¿æŒRunneræ´»è·ƒï¼‰

jobs:
  start-proxy:
    runs-on: self-hosted  # å…³é”®ï¼ä½¿ç”¨è‡ªæ‰˜ç®¡Runner
    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v4

      - name: è®¾ç½®Pythonç¯å¢ƒ
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: å®‰è£…ä¾èµ–
        run: |
          pip install flask requests

      - name: å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆè¿è¡Œ2å°æ—¶åè‡ªåŠ¨é€€å‡ºï¼‰
        run: |
          echo "ğŸš€ å¯åŠ¨APIä»£ç†æœåŠ¡å™¨ï¼Œå°†åœ¨2å°æ—¶åè‡ªåŠ¨å…³é—­..."
          timeout 7200 python proxy_server.py  # 7200ç§’ = 2å°æ—¶
        timeout-minutes: 130  # ç•™ç‚¹ä½™é‡

      - name: æ¸…ç†ï¼ˆå¯é€‰ï¼‰
        if: always()
        run: |
          echo "âœ… ä»£ç†æœåŠ¡å·²åœæ­¢"
